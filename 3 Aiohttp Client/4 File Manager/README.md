# Работа с Файлами

## Введение

Эффективная работа с файлами - не самая тривиальная задача, которая может показаться на первый взгляд. С маленькими файлами все может работать просто. Они целиком помещаются в памяти программы, ими легко оперировать, что позволяет их быстро передавать клиенту. Проблемы же начинаются при работе с объемными файлами. Такие файлы уже нельзя так просто хранить целиком в памяти веб-сервера при обработке. С ними нужно работать по частями.

### Streaming

Это подход, позволяющий эффективно работать с файлами. Основная идея в том, что большинство операций с большими файлами веб-сервер являются proxy между клиентом и файловом хранилищем. Поэтому нам нет необходимости хранить весь файл целиком. Достаточно оперировать в один момент времени небольшими частями этого файла. Эти части называются чанками (chunks).

Примеры, когда streaming подходит, а когда нет:

-   Вы создаете платформу, на которой есть достаточно длинные видеозаписи. В качестве хранилища записей используется Vimeo или S3-хранилище. В этом случае подход с чанками оправдан, потому что видео может быть тяжелым в плане памяти. Мы не обрабатываем его на лету, а просто проксируем видео в хранилище.

-   Вы делаете социальную сеть, и нужно сделать загрузку аватарок пользователей. В этом случае картинки относительно маленькие. К тому же велика вероятность, что картинку нужно будет как-то обработать, а для этого нужен весь файл. Поэтому подход с чанками использовать не стоит.
